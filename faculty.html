<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Faculty — Assam Horizon Sr. Secondary School</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="assets/css/styles.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  </head>
  <body class="d-flex flex-column min-vh-100">
    <nav class="navbar navbar-expand-lg bg-white border-bottom sticky-top">
      <div class="container">
        <a class="navbar-brand fw-bold" href="index.html">
          Assam Horizon <span class="brand-accent"> Sr. Secondary School</span>
        </a>
        <button class="navbar-toggler ms-auto" type="button" data-bs-toggle="collapse" data-bs-target="#nav" aria-controls="nav" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="nav">
          <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
            <li class="nav-item"><a class="nav-link" href="academics.html">Academics</a></li>
            <li class="nav-item"><a class="nav-link" href="admissions.html">Admissions</a></li>
            <li class="nav-item"><a class="nav-link active" href="faculty.html">Faculty</a></li>
            <li class="nav-item"><a class="nav-link" href="gallery.html">Gallery</a></li>
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="#" data-bs-toggle="dropdown">Portals</a>
              <ul class="dropdown-menu dropdown-menu-end">
                <!-- <li><a class="dropdown-item" href="portal.html">Academics Portal</a></li> -->
                <!-- <li><a class="dropdown-item" href="parent-portal.html">Parent Portal</a></li> -->
                <li><a class="dropdown-item" href="admin.html">Admin Backend</a></li>
              </ul>
            </li>
            <li class="nav-item"><a class="nav-link" href="contact.html">Contact</a></li>
            <li class="nav-item"><a class="nav-link" href="notice.html">Notice Board</a></li>
          </ul>
        </div>
      </div>
    </nav>

    <main class="py-5">
      <div class="container">
        <div class="text-center mb-4">
          <h1 class="fw-bold">Our Faculty</h1>
          <p class="text-secondary">Experienced educators dedicated to student success.</p>
        </div>

        <!-- Loading Spinner -->
        <div id="facultyLoading" class="text-center py-5">
          <div class="spinner-border text-primary" role="status">
            <span class="visually-hidden">Loading...</span>
          </div>
          <p class="mt-3 text-muted">Loading faculty information...</p>
        </div>

        <!-- No Faculty Message -->
        <div id="noFaculty" class="text-center py-5" style="display: none;">
          <i class="fas fa-chalkboard-teacher fa-3x text-muted mb-3"></i>
          <h4 class="text-muted">No faculty information available</h4>
          <p class="text-muted">Check back later for updates.</p>
        </div>

        <!-- Faculty Grid -->
        <div id="facultyGrid" class="row g-4" style="display: none;">
          <!-- Faculty cards will be dynamically loaded here -->
        </div>
      </div>

      <!-- Lightbox Modal -->
      <div class="modal fade" id="lightboxModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-lg">
          <div class="modal-content bg-dark">
            <div class="modal-body p-0">
              <img id="lightboxImg" alt="Faculty Photo" class="img-fluid w-100" />
            </div>
            <div class="modal-footer border-0">
              <button type="button" class="btn btn-outline-light" data-bs-dismiss="modal">Close</button>
            </div>
          </div>
        </div>
      </div>
    </main>

    <footer class="site-footer py-4 mt-auto">
      <div class="container d-flex flex-column flex-md-row justify-content-between align-items-center gap-2">
        <div>© <span id="year"></span> Assam Horizon Sr. Secondary School</div>
        <div class="d-flex gap-3">
          <a href="notice.html">Notice Board</a>
          <a href="contact.html">Contact</a>
          <a href="admissions.html">Admissions</a>
        </div>
      </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <script src="assets/js/main.js"></script>
    <script>
      // Supabase configuration
      const SUPABASE_URL = 'https://mrthnvwokprolhaoimpg.supabase.co'; // Replace with your Supabase URL
      const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im1ydGhudndva3Byb2xoYW9pbXBnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTkwNzExODYsImV4cCI6MjA3NDY0NzE4Nn0.5nncUpTZXKEMC65Bdcr5JRmzulUZRHWrRhPbVLV8Tzo'; // Replace with your Supabase anon key
      
      // Initialize Supabase client (only if not already declared)
      if (typeof supabase === 'undefined') {
        var supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
      }

      // Set current year in footer
      document.getElementById("year").textContent = new Date().getFullYear();

      // Load faculty members on page load
      document.addEventListener('DOMContentLoaded', function() {
        loadFacultyMembers();
      });

      // Function to load faculty members from Supabase
      async function loadFacultyMembers() {
        const loadingDiv = document.getElementById('facultyLoading');
        const noFacultyDiv = document.getElementById('noFaculty');
        const facultyGrid = document.getElementById('facultyGrid');

        try {
          loadingDiv.style.display = 'block';
          noFacultyDiv.style.display = 'none';
          facultyGrid.style.display = 'none';

          // Fetch faculty members from Supabase
          const { data: faculty, error } = await supabase
            .from('faculty')
            .select('*')
            .eq('is_active', true)
            .order('display_order', { ascending: true });

          if (error) {
            throw error;
          }

          loadingDiv.style.display = 'none';

          if (!faculty || faculty.length === 0) {
            noFacultyDiv.style.display = 'block';
            return;
          }

          // Display faculty members
          facultyGrid.innerHTML = faculty.map(member => {
            return `
              <div class="col-6 col-md-4 col-lg-3">
                <div class="card h-100 card-hover text-center">
                  <img src="${member.photo_url || 'assets/images/placeholder-avatar.jpg'}" 
                       class="card-img-top faculty-image" 
                       alt="${escapeHtml(member.name)}"
                       title="${escapeHtml(member.name)}"
                       data-faculty-name="${escapeHtml(member.name)}"
                       data-faculty-role="${escapeHtml(member.role)}"
                       data-faculty-subject="${escapeHtml(member.subject)}"
                       data-faculty-qualification="${escapeHtml(member.qualification || '')}"
                       data-faculty-experience="${escapeHtml(member.experience || '')}"
                       style="height: 200px; object-fit: cover; cursor: pointer;">
                  <div class="card-body">
                    <h6 class="mb-1">${escapeHtml(member.name)}</h6>
                    <small class="text-secondary d-block">${escapeHtml(member.role)}</small>
                    <small class="text-secondary">${escapeHtml(member.subject)}</small>
                    ${member.qualification ? `<small class="text-muted d-block mt-1">${escapeHtml(member.qualification)}</small>` : ''}
                    ${member.experience ? `<small class="text-muted d-block">${escapeHtml(member.experience)}</small>` : ''}
                    ${member.bio ? `<p class="card-text small text-muted mt-2">${escapeHtml(member.bio).substring(0, 80)}${member.bio.length > 80 ? '...' : ''}</p>` : ''}
                    ${member.email ? `<small class="text-primary d-block"><i class="fas fa-envelope me-1"></i>${escapeHtml(member.email)}</small>` : ''}
                    ${member.phone ? `<small class="text-primary d-block"><i class="fas fa-phone me-1"></i>${escapeHtml(member.phone)}</small>` : ''}
                  </div>
                </div>
              </div>
            `;
          }).join('');

          facultyGrid.style.display = 'flex';

          // Initialize lightbox functionality for faculty images
          initializeFacultyLightbox();

        } catch (error) {
          console.error('Error loading faculty members:', error);
          loadingDiv.style.display = 'none';
          facultyGrid.innerHTML = `
            <div class="col-12 text-center">
              <div class="alert alert-danger" role="alert">
                <i class="fas fa-exclamation-triangle me-2"></i>
                Error loading faculty information. Please try again later.
              </div>
            </div>
          `;
          facultyGrid.style.display = 'block';
        }
      }

      // Function to escape HTML to prevent XSS
      function escapeHtml(text) {
        const div = document.createElement('div');
        div.textContent = text;
        return div.innerHTML;
      }

      // Function to initialize lightbox functionality for faculty images
      function initializeFacultyLightbox() {
        const facultyImages = document.querySelectorAll('.faculty-image');
        const lightboxModal = document.getElementById('lightboxModal');
        const lightboxImg = document.getElementById('lightboxImg');

        facultyImages.forEach(img => {
          img.addEventListener('click', function() {
            lightboxImg.src = this.src;
            lightboxImg.alt = this.alt;
            
            // Update modal title with faculty info
            const name = this.dataset.facultyName || this.alt;
            const role = this.dataset.facultyRole;
            const subject = this.dataset.facultySubject;
            const qualification = this.dataset.facultyQualification;
            const experience = this.dataset.facultyExperience;
            
            let modalTitle = name;
            if (role) {
              modalTitle += ` - ${role}`;
            }
            if (subject) {
              modalTitle += ` (${subject})`;
            }
            if (qualification) {
              modalTitle += ` - ${qualification}`;
            }
            if (experience) {
              modalTitle += ` - ${experience}`;
            }
            
            // You can add a title element to the modal if needed
            const modal = new bootstrap.Modal(lightboxModal);
            modal.show();
          });
        });
      }

      // Auto-refresh faculty every 5 minutes
      setInterval(loadFacultyMembers, 300000);
    </script>
  </body>
</html>




